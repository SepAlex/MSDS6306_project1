---
Title: "MSDS 6306 - Case Study 1- The Beer Project"
author: "Chew Swee, Orlov Volodymy, andMwangi Julius"
Date: "7/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

According to a report issued by the Brewers Association in 2016, "the economic impact of small and independent U.S. craft brewers has doubled," in the last four years. The study further reported that the inustry contributed $68.7B to the industry and provides more than 456,000 full time jobs (https://www.brewbound.com/news/study-us-craft-beer-industry-contributes-68-billion-economy).

Our client would like us to provide mor information on the the beer industry past trends. Our study will be geered towards understanding the beer industry and establishing possibilities for our client, on the premise that the beer industry is flourishing with an insatiable demand. Our research questions are; how many breweries are there in the United States; What brands of beer are produced most; How many ounces are commonly produced; Which brewery produces most brands of beer; Which state produces most beer; what is the alcoholic content and bitterness variability across the states; and is there a relationship between alcoholic contents and bitterness.

Analysing the industry's landscape will help our client determine whether it is beneficial to venture in the beer industry. Our study will provide a birds eye view on the overal brewing industry.This study will help our client understand the industry's growth stage i.e. whether it is exponential, stabilized, or declining. We will provide our client with sufficient data to better understand how many breweries there are in the industry and what type of beer they are producing.

## Data

We obtained two datasets consisting  2 files. The first,"Beers.csv"contains a list of 2410 US craft beers.Each beer in the beers dataset is described by name, id, alcoholic content and bitterness, style and ounces. The second dataset, "Breweries.csv" contains 558 US breweries and 2305 distinct beers.  Each brewery is described by name, id, city and state. Our research will involve collating and analysing the two datasets. We shall use these two datasets help us understand the breweries per state, the beer brands in the different breweries, the beer quality in terms of alcohol content and international bitterness unit and which states have beers with most alochol and most bitter.
Caveate: We have no information whether the data  collected was voluntary or as a result of state reporting requirement, as such we can vet into it's accuracy hence reliability.

```{r breweries}
beers <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Beers.csv', header=T, sep=",")
breweries <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Breweries.csv', header=T, sep=",")
```

### Breweries per State

The 'summary' function is used to obtain the summary statistic of 'State' column within 'breweries' data set. Below is a list of 51 states  with the number of breweries present in each state:
```{r breweries1}
summary(breweries$State)
```
The top five states are CO(47), CA(39), MI(32),OR(29), and PA(25). Of these, four of them are in the west coast and only one is in the east coast. Overall there are 23 states with five breweries and below. The states with only one brewery are, DC,ND, SD,and WV.Two of these in the east coast and two in the midwestern. From this data we cannot detect any correlation between the breweries and the location.

### Beer Brands and Corresponding Breweries

We merged the two datasets to generate beer brands and the corresponding breweries. Due to the volume of data generated, we selected the first and last six beer brands and the corresponding breweries. 

We used a common variable to merge the two datasets. In this case, the common variable between the two datasets is the brewery id associated with the beer. However, since the variable names are not the same, we renamed 'Brew_ID' within the 'breweries' dataset to 'Brewery_id' to match with the variable name within the 'beers' dataset.

*We used the 'merge' function to merge the 'breweries' and the 'beers' datasets by 'Brewery_id' and  assigned to an object 'beers_breweries.' 

*The 'head' and 'tail' functions are used to print the first and last six observations respectively. Below are the brands and their corresponding breweries.

```{r breweries2}
names(breweries)[names(breweries) == "Brew_ID"] <- "Brewery_id"
beers_breweries <- merge(breweries,beers,by="Brewery_id")
head(beers_breweries)
tail(beers_breweries)
```
**We found that...*this code pulls up data for Minnesota only...What we expected to see is the different beer brands and the breweries that produce them. if the specifics are available the better but I think there's a laer question that speaks to that.

### Report the number of NA's 

As we go to the specifics of the data we want to establish whether all breweries provided the standard infration required, in this case the alcohol content and bitterness meaurements...**This will help us separate those breweries without complete data or with partial data. *is it possible to see the states or breweries with ABV and IBU ?"NA's"
The 'is.na' function is used to identify the NA's in the merged dataset 'beers_breweries', which will return a logical vector with TRUE/FALSE. 'colSums' function is applied afterwards to obtain the total count of 'TRUE' in each column. 

From our analysis, 62 Only 'ABV' and 'IBU' columns contain NA's, 62 and 1005 NA's respectively.
```{r breweries3}
  colSums(is.na(beers_breweries))
```

### Median Alcohol Content (ABV) per State

The 'tapply' function is used to compute the median alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the median. IBU is an abbreviation for the International Bitterness Units scale, a gauge of beer's bitterness. What IBUs measure are the parts per million of isohumulone found in a beer according t0 the website, https://beerconnoisseur.com. It further adds that isohumulone is the acid found in hops that gives beer its bitter bite.  It's measurement raganges from 0-100, with 100 being the highest. Bitterness however is relative, as often its sweatened. On the other hand, alcohol by volume content is measured as a percentage. It shows how much of the beer is alcohol and legaly  required to be imprinted on the beer. 

From our datasets, the State of Utah  has the lowest median alcohol by volume at 0.40 while Washington DC and Kentucky have the highest median alcohol by volumne of the beer at 0.625.
```{r breweries4}
median_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, median, na.rm = TRUE)
median_ABV
barplot(median_ABV, xlab = "State", ylab = "Median Alcohol Content", main = "Median Alcohol Content by State", col = "blue", las =2, cex.axis = .5, cex.names = .5)
```

### International Bitterness Unit (IBU) per State

On IBU measurement, Wisconsin has the lowest IBU measurement at 19.0, while Maine has the highest at 61.0. There was no IBU data for South Dakota. This is rather odd as in the united states, IBU percetage is required to be printed on the beer. The most likely reason is that the only brewery in South Dakota did not provide the data.  
```{r breweries5}
median_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, median, na.rm = TRUE)
median_IBU
barplot(median_IBU, xlab = "State", ylab = "Median International Bitterness Unit", main = "Median International Bitterness Unit by State", col = "green", las =2, cex.axis = .5, cex.names = .5)
```

### State with the maximum alcoholic (ABV) beer 

According to a post in a beer bloggers website  (https://www.ratebeer.com), humans can only detect up to about 100 IBUs in beer, as such any measurement above 100 is a waste as the human taste buds cannot experience the bitterness.

The 'tapply' function is used to compute the maximum alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the maximum. 

From our analysis, Colorado has the maximum alcohol by volume of the beer at 0.128, followed by Kentucky with 0.125, Indiana with 0.12, and New York with 0.10.  The lowest was Delaware with 0.055.
```{r breweries6}
max_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, max, na.rm = TRUE)
max_ABV1 <- sort(max_ABV, decreasing = TRUE)
head(max_ABV1,1)
````

### State with the most bitter (IBU) beer

From our analysis below,  Sixteen states reported beer with an IBU exceeding 100 with Oregon in the west coast with the most bitter beer at 138 IBU. 
```{r breweries6}
max_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, max, na.rm = TRUE)
max_IBU1 <- sort(max_IBU, decreasing = TRUE)
max_IBU1
```

### Summary statistics for ABV variable

There were 62 beers that did not return any ABV. This could most likely be because the breweries did not provide the data. 
The 'summary' function is used to obtain the summary statistics for the ABV variable in 'beers_breweries' dataset.  
*...**we need to run acode that identifies the staes associated with the NA abv variables** What can we say of the states e.g. location and of the type of beers do the beers have a high IBU? 
```{r breweries7}
summary(beers_breweries$ABV)
```

### Relationship between Bitterness and alcoholic content in the Beer 

To determine whether there is a relationship between the bitterness of the beer and its alocholic content we plotted the ABV data against the IBU to obtain a scatter plot graph below.
```{r breweries8}
plot(beers_breweries$ABV,beers_breweries$IBU, xlab = "Alcoholic Content", ylab = "Bitterness of the Beer", main = "Correlation between Bitterness and Alcohol by Volume of the Beer", col = "blue")
```
Based on the scatter plot, it seems that there is a positive linear relationship between the bitternees and the alcohol by volume of the beer. The relationship appears to concentrate between the 0.04 and 40% and intensifies at 0.075 ABV and 100%. We can conclusively say that there is a relationship which intensifies at the lower ABV levels and lower IBU, and starts to scater as the measeurmenst increases.

### Conclusion
