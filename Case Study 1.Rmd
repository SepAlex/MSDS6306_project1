---
title: "MSDS 6306 - Case Study 1"
author: "Swee K Chew"
date: "7/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

According to a report issued by the Brewers Association in 2016, "the economic impact of small and independent U.S. craft brewers has doubled," in the last four years. The study further reported that the inustry contributed $68.7B to the industry and provides more than 456,000 full time jobs (https://www.brewbound.com/news/study-us-craft-beer-industry-contributes-68-billion-economy).

Our client would like us to provide mor information on the the beer industry, specifically  past trends, production and supply mechanics, and evaluate plausible future outlook. Our study will be geered towards understanding the beer industry and establishing expansion possibilities for our client, on the premise that the beer industry is flourishing with an insatiable demand. We will from our research answer the questions; how many breweries are there and how are they distributed in the country; Which brewery ranks highest in production; what brands of beer are produced most; How many ounces are commonly produced; Which brewery produces most brands of beer; which location produces most beer; among others.

This study will reveal the market competition and whether the industry has potential for growth and how far it from saturation. Analysing the industry's landsacpe to help our client determine whether it is beneficial to invest on expansion either throug purchasing existing breweries or establishhing new ones ad oin whcih locations. Our study will provide a birds eye view on the overal brewing industry.This study will help our client understand the industry's growth stage i.e. whether it is exponential, stabilized or declining. we will provide our client with sufficient data to better understand how many competitors there are in the industry; and what type of beer they are producing.

We have cautioned our client that this study focuses only on production, location, type of beer and size. More research focusing on financial data is necessary and should be considered pari pasu our report. 

## Datasets: 'Beers.csv' and 'Breweries.csv'

Our research will involve investigating and collating two datasets, the first, "Beers.csv"contains a list of 2410 US craft beers and the second, "Breweries.csv" contains 558 US breweries. The two datasets are read using the R software prior to analysis. We assigned the Beers dataset to an object 'beers,' and the Breweries dataset to an object 'breweries. We shall use these two datasets help us understand the breweries per state, the beer brands in the different breweries, the beer quality in terms of alcohol content and international bitterness unit and which states have beers with most alochol and most bitter.

```{r breweries}
beers <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Beers.csv', header=T, sep=",")
breweries <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Breweries.csv', header=T, sep=",")
```

### 1. Breweries per state

The 'summary' function is used to obtain the summary statistic of 'State' column within 'breweries' data set. Below is a list of 51 states  with the number of breweries present in each state:
```{r breweries1}
summary(breweries$State)
```

### 2. Beer brands and corresponding breweries

We merged the two datasets to generate beer brands and the corresponding breweries. Due to the volume of data generated, we selected the first and last six beer brands and the corresponding breweries. 

We used a common variable to merge the two datasets. In this case, the common variable between the two datasets is the brewery id associated with the beer. However, since the variable names are not the same, we renamed 'Brew_ID' within the 'breweries' dataset to 'Brewery_id' to match with the variable name within the 'beers' dataset.

The 'merge' function is used to merge the 'breweries' and the 'beers' datasets by 'Brewery_id' and  assigned to an object 'beers_breweries.' 

The 'head' and 'tail' functions are used to print the first and last six observations respectively. Below are the brands and their corresponding breweries.

```{r breweries2}
names(breweries)[names(breweries) == "Brew_ID"] <- "Brewery_id"
beers_breweries <- merge(breweries,beers,by="Brewery_id")
head(beers_breweries)
tail(beers_breweries)
```

### 3. Report the number of NA's in each column.

The 'is.na' function is used to identify the NA's in the merged dataset 'beers_breweries', which will return a logical vector with TRUE/FALSE. 'colSums' function is applied afterwards to obtain the total count of 'TRUE' in each column. 

Only 'ABV' and 'IBU' columns contain NA's, 62 and 1005 NA's respectively.
```{r breweries3}
colSums(is.na(beers_breweries))
```

### 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

The 'tapply' function is used to compute the median alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the median. 

UT State has the lowest median alcohol by volumn. DC and KY are the states with the highest median alcohol by volumne of the beer.
```{r breweries4}
median_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, median, na.rm = TRUE)
median_ABV
barplot(median_ABV, xlab = "State", ylab = "Median Alcohol Content", main = "Median Alcohol Content by State", col = "blue", las =2, cex.axis = .5, cex.names = .5)
```

WI State has the lowest median international bitterness unit and ME State has the highest median international bitterness unit. There is no IBU data for SD State. 
```{r breweries5}
median_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, median, na.rm = TRUE)
median_IBU
barplot(median_IBU, xlab = "State", ylab = "Median International Bitterness Unit", main = "Median International Bitterness Unit by State", col = "green", las =2, cex.axis = .5, cex.names = .5)
```

### 5. State the maximum alcoholic (ABV) beer and state with the most bitter (IBU) beer.

The 'tapply' function is used to compute the maximum alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the maximum. From our analysis, the state of Colorado has the maximum alcohol by volume of the beer while Oregoon has the most bitter beer.
```{r breweries6}
max_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, max, na.rm = TRUE)
max_ABV1 <- sort(max_ABV, decreasing = TRUE)
head(max_ABV1,1)

max_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, max, na.rm = TRUE)
max_IBU1 <- sort(max_IBU, decreasing = TRUE)
head(max_IBU1,1)
```

### 6. Summary statistics for the ABV variable.

The 'summary' function is used to obtain the summary statistics for the ABV variable in 'beers_breweries' dataset.  

The NA count and the maximum ABV in the output match with the responses in Q3 and Q5.
```{r breweries7}
summary(beers_breweries$ABV)
```

### 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.

The 'plot' function is used to obtain a scatter plot.
```{r breweries8}
plot(beers_breweries$ABV,beers_breweries$IBU, xlab = "Alcoholic Content", ylab = "Bitterness of the Beer", main = "Correlation between Bitterness and Alcohol by Volume of the Beer", col = "blue")
```

Based on the scatter plot, it seems that there is a positive linear relationship between the bitternees and the alcohol by volume of the beer. 
