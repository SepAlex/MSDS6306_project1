---
title: "MSDS 6306 - Case Sutdy 1"
author: "Swee K Chew"
date: "6/7/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

### 1. How many breweries are present in each state?
```{r breweries1}
breweries_data <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Breweries.csv', header=T, sep=",")
beers_data <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Beers.csv', header=T, sep=",")
summary(breweries_data$State)
```

### 2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.
```{r breweries2}
names(breweries_data)[names(breweries_data) == "Brew_ID"] <- "Brewery_id"
merge_data <- merge(breweries_data,beers_data,by="Brewery_id")
head(merge_data)
tail(merge_data)
```

### 3. Report the number of NA's in each column.
```{r breweries3}
na_count <-function (x) sapply(x, function(y) sum(is.na(y)))
na_count(merge_data)
colSums(is.na(merge_data))
```

### 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.
```{r breweries4}
median_ABV <- tapply(merge_data$ABV, merge_data$State, median, na.rm = TRUE)
median_ABV
barplot(median_ABV, xlab = "State", ylab = "Median Alcohol Content", main = "Median Alcohol Content by State", col = "blue", las =2, cex.axis = .5, cex.names = .5)

median_IBU <- tapply(merge_data$IBU, merge_data$State, median, na.rm = TRUE)
median_IBU
barplot(median_IBU, xlab = "State", ylab = "Median International Bitterness Unit", main = "Median International Bitterness Unit by State", col = "green", las =2, cex.axis = .5, cex.names = .5)
```

### 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?
```{r breweries5}
max_ABV <- tapply(merge_data$ABV, merge_data$State, max, na.rm = TRUE)
max_ABV1 <- sort(max_ABV, decreasing = TRUE)
head(max_ABV1,1)

max_IBU <- tapply(merge_data$IBU, merge_data$State, max, na.rm = TRUE)
max_IBU1 <- sort(max_IBU, decreasing = TRUE)
head(max_IBU1,1)
```

### 6. Summary statistics for the ABV variable.
```{r breweries6}
summary(merge_data$ABV)
```

### 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.
```{r breweries7}
plot(merge_data$ABV,merge_data$IBU, xlab = "Alcoholic content", ylab = "Bitterness of the Beer", main = "Correlation between Bitterness of the Beer and its Alcohic content", col = "blue")
```

