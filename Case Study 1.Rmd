---
title: "MSDS 6306 - Case Sutdy 1"
author: "Swee K Chew"
date: "7/10/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Datasets: 'Beers.csv' and 'Breweries.csv'

The Beers dataset contains a list of 2410 US craft beers and Breweries dataset contains 558 US breweries.

The two datasets are read into R prior to analysis. The Beers dataset is assigned to an object 'beers' and the Breweries dataset is assigned to an object 'breweries'. 
```{r breweries}
beers <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Beers.csv', header=T, sep=",")
breweries <- read.csv ('/Users/swee/Desktop/SMU/Summer 2018/MSDS 6306 - Doing DS/dataset/Breweries.csv', header=T, sep=",")
```

## Questions to Address

### 1. How many breweries are present in each state?

The 'summary' function is used to obtain the summary statistic of 'State' column within 'breweries' data set.

Below is a list of 51 states along with the number of breweries that are present in each state:
```{r breweries1}
summary(breweries$State)
```

### 2. Merge beer data with the breweries data. Print the first six observations and the last six observations to check the merged file.

A common variable is needed to merge two or more dataset. In this case, the common variable between the two datasets is the brewery id associated with the beer. However, since the variable names are not the same, 'Brew_ID' within the 'breweries' dataset is renamed to 'Brewery_id' to match with the variable name within the 'beers' dataset.

The 'merge' fuction is used to merge the 'breweries' and the 'beers' datasets by 'Brewery_id' and it is assigned to an object 'beers_breweries'. 

The 'head' and 'tail' functions are used to print the first and last six observations respectively. 
```{r breweries2}
names(breweries)[names(breweries) == "Brew_ID"] <- "Brewery_id"
beers_breweries <- merge(breweries,beers,by="Brewery_id")
head(beers_breweries)
tail(beers_breweries)
```

### 3. Report the number of NA's in each column.

The 'is.na' function is used to identify the NA's in the merged dataset 'beers_breweries', which will return a logical vector with TRUE/FALSE. 'colSums' function is applied afterwards to obtain the total count of 'TRUE' in each column. 

Only 'ABV' and 'IBU' columns contain NA's, 62 and 1005 NA's respectively.
```{r breweries3}
colSums(is.na(beers_breweries))
```

### 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

The 'tapply' function is used to compute the median alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the median. 

UT State has the lowest median alcohol by volumn. DC and KY are the states with the highest median alcohol by volumne of the beer.
```{r breweries4}
median_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, median, na.rm = TRUE)
median_ABV
barplot(median_ABV, xlab = "State", ylab = "Median Alcohol Content", main = "Median Alcohol Content by State", col = "blue", las =2, cex.axis = .5, cex.names = .5)
```

WI State has the lowest median international bitterness unit and ME State has the highest median international bitterness unit. There is no IBU data for SD State. 
```{r breweries5}
median_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, median, na.rm = TRUE)
median_IBU
barplot(median_IBU, xlab = "State", ylab = "Median International Bitterness Unit", main = "Median International Bitterness Unit by State", col = "green", las =2, cex.axis = .5, cex.names = .5)
```

### 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

The 'tapply' function is used to compute the maximum alcohol by volume (ABV) and international bitterness unit (IBU) for each state. Since both variables contain NA's, 'na.rm' argument is used to remove NA's when computing the maximum. 

CO State has the maximum alcohol by volume of the beer and OR State has the most bitter beer.
```{r breweries6}
max_ABV <- tapply(beers_breweries$ABV, beers_breweries$State, max, na.rm = TRUE)
max_ABV1 <- sort(max_ABV, decreasing = TRUE)
head(max_ABV1,1)

max_IBU <- tapply(beers_breweries$IBU, beers_breweries$State, max, na.rm = TRUE)
max_IBU1 <- sort(max_IBU, decreasing = TRUE)
head(max_IBU1,1)
```

### 6. Summary statistics for the ABV variable.

The 'summary' function is used to obtain the summary statistics for the ABV variable in 'beers_breweries' dataset.  

The NA count and the maximum ABV in the output match with the responses in Q3 and Q5.
```{r breweries7}
summary(beers_breweries$ABV)
```

### 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic content? Draw a scatter plot.

The 'plot' function is used to obtain a scatter plot.
```{r breweries8}
plot(beers_breweries$ABV,beers_breweries$IBU, xlab = "Alcoholic Content", ylab = "Bitterness of the Beer", main = "Correlation between Bitterness and Alcohol by Volume of the Beer", col = "blue")
```

Based on the scatter plot, it seems that there is a positive linear relationship between the bitternees and the alcohol by volume of the beer. 
